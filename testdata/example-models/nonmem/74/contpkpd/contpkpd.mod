$PROB RUN# 1 DIRECT POPULATION PKPD MODEL
$INPUT C ID AMT TIME DV TYPE DROP
;TYPE 0 = PK, TYPE 1=PD
;DV=PK & PD DATA ORDERED BY ID, TIME
$DATA pkpd.csv IGNORE=C ;combined data set
$SUBROUTINE ADVAN2 TRANS2

$PK
 KA=THETA(1)*EXP(ETA(1))
 CL=THETA(2)*EXP(ETA(2))
 V=THETA(3)*EXP(ETA(3))
 S2=V
$ERROR
EMAX=THETA(4)*EXP(ETA(4))
EC50=THETA(5)*EXP(ETA(5))
E0=THETA(6)*EXP(ETA(6))
EFF=E0+EMAX*F/(EC50+F)+ERR(2)
CONC=F + F*ERR(1)
Y=EFF*TYPE + CONC*(1-TYPE)
TYP2=TYPE
IPRED=Y

$THETA
(0, 1.7)     ;KA
(0, 4.7)     ;CL
(0, 38)     ;V
(0, 100) ;EMAX
(0,5)  ;EC50
(0, 60) ;E0
$OMEGA
0.04
0.04
0.04
0.04
0.04
0.04
 
$SIGMA
0.04
5
$ESTIMATION MAXEVAL=9999 method=1 POSTHOC MSFO=./1.msf
$COV 
$TABLE NOPRINT FILE=./1.tab ONEHEADER
ID TIME TYPE EVID EFF CONC IPRED TYP2
